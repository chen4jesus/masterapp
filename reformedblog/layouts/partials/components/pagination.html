{{ $paginator := .Paginator }}
{{ $adjacent_links := 2 }}
{{ $max_links := (add (mul $adjacent_links 2) 1) }}
{{ $lower_limit := (add $adjacent_links 1) }}
{{ $upper_limit := (sub $paginator.TotalPages $adjacent_links) }}

{{ if gt $paginator.TotalPages 1 }}
<nav class="flex justify-center items-center gap-2 mt-8 flex-wrap">

    <!-- Previous Page -->
    {{ if $paginator.HasPrev }}
    <a href="{{ $paginator.Prev.URL }}" class="flex items-center justify-center w-10 h-10 rounded-lg bg-gray-100 dark:bg-white/10 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-white/20 transition-all duration-200">
        <i class="fa-solid fa-chevron-left text-sm"></i>
    </a>
    {{ end }}

    <!-- Page Numbers -->
    {{ $last_printed := 0 }}
    {{ range $paginator.Pagers }}
        {{ $.Scratch.Set "page_number_flag" false }}

        <!-- Logic to determine if we should show this page -->
        <!-- Logic: Always show First, Last, and a window around Current -->
        {{ if or (eq .PageNumber 1) (eq .PageNumber $paginator.TotalPages) }}
            {{ $.Scratch.Set "page_number_flag" true }}
        {{ else if and (ge .PageNumber (sub $paginator.PageNumber $adjacent_links)) (le .PageNumber (add $paginator.PageNumber $adjacent_links)) }}
            {{ $.Scratch.Set "page_number_flag" true }}
        {{ end }}

        <!-- Rendering -->
        {{ if eq ($.Scratch.Get "page_number_flag") true }}
            <!-- Check for gap -->
            {{ if gt .PageNumber (add $last_printed 1) }}
                <span class="flex items-center justify-center w-10 h-10 text-gray-400">...</span>
            {{ end }}

            {{ if eq . $paginator }}
                <span class="flex items-center justify-center w-10 h-10 rounded-lg bg-black dark:bg-white text-white dark:text-black font-medium transition-all duration-200">
                    {{ .PageNumber }}
                </span>
            {{ else }}
                <a href="{{ .URL }}" class="flex items-center justify-center w-10 h-10 rounded-lg bg-gray-100 dark:bg-white/10 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-white/20 transition-all duration-200 font-medium">
                    {{ .PageNumber }}
                </a>
            {{ end }}

            {{ $last_printed = .PageNumber }}
        {{ end }}
    {{ end }}

    <!-- Next Page -->
    {{ if $paginator.HasNext }}
    <a href="{{ $paginator.Next.URL }}" class="flex items-center justify-center w-10 h-10 rounded-lg bg-gray-100 dark:bg-white/10 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-white/20 transition-all duration-200">
        <i class="fa-solid fa-chevron-right text-sm"></i>
    </a>
    {{ end }}
</nav>

<!-- Page Count Info (matching JS style) -->
<p class="text-center mt-4 text-sm opacity-60">
    {{ T "total_articles" | default "共" }} {{ $paginator.TotalNumberOfElements }} {{ T "articles" | default "篇文章" }} • {{ T "page" | default "第" }} {{ $paginator.PageNumber }} / {{ $paginator.TotalPages }} {{ T "page_suffix" | default "页" }}
</p>
{{ end }}
